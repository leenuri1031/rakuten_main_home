/*
 suggest.js 2.0.1
 Copyright (c) 2012 Rakuten.Inc
 Date : 2012-11-16 11:05:00
*/
(function(){if("undefined"!=typeof jQuery){jQuery.noConflict();var e=jQuery,f=function(){};f.prototype={resultArray:[],backup:"",lastInput:"",respInput:null,sggstSelectNum:-1,usingChar:"",mouseInput:null,mouseState:0,mouseMove:0,mouseOver:0,enterFlag:1,keyCode:null,currentFontSize:null,maxIndex:0,index:-1,clickEnableFlag:1,IeVersion:0,viewEvent:null,ajaxEvent:null,suggestDivPos:null,onoff:1,onoffInitFlag:0,onElem:null,offElem:null,decisionFlag:0,scVal:0,submitWay:0,blackList:["iphone","ipod","ipad",
"android"],onOffBlackList:[],spaceRegExp:RegExp("^[\\s"+unescape("\u3000")+"]+"),preInit:function(){this.suggestDivPos=this.input.parent();return!0},postInit:function(){},checkBoolNum:function(a){return"undefined"!=typeof a&&0!=a.length&&(0==a||1==a)?a:""},escapeHtml:function(a){return e("<div/>").text(a).html()},initFailure:function(){rsuggest.input.attr("autocomplete","")},createSuggestDiv:function(){this.suggest=e("<div />").attr("id","suggest").hide().appendTo(this.suggestDivPos);for(var a=e("<div />").append(e("<div />").attr("class",
this.cssNoSelect).append(e("<span />").attr("class",this.cssKeyword))),d="",c=0,b=this.count;c<b;c++)d+=a.html();this.suggest.append(d);this.suggest.delegate("."+this.cssKeyword,"mouseup",function(a){var b=e(this).text();1!=a.which||(rsuggest.mouseInput!=b||0==rsuggest.clickEnableFlag)||(rsuggest.mouseState=2,rsuggest.input.blur(),rsuggest.input.val(b),rsuggest.sggstSelectNum=rsuggest.index,rsuggest.usingChar=b,rsuggest.clickEnableFlag=0,rsuggest.decisionFlag=1,rsuggest.submitWay=2,setTimeout(function(){rsuggest.button.click()},
10),rsuggest.eventStop())});this.suggest.delegate("."+this.cssKeyword,"mousedown",function(a){if(1!=a.which)rsuggest.input.blur();else return rsuggest.mouseInput=e(this).text(),rsuggest.mouseState=1,!1});this.suggest.delegate("."+this.cssKeyword,"mouseover",function(){rsuggest.over(e(this).text())});this.suggest.delegate("."+this.cssKeyword,"mouseout",function(){rsuggest.mouseState=0});this.suggest.delegate("."+this.cssKeyword,"mousemove",function(){rsuggest.mouseMove=1});this.remarks=e("<div />").attr("class",
this.cssRemarks).append(e("<div />").attr("class",this.cssRemarksBox).append(e("<div />").attr("class",this.cssComment).append(e("<div />").attr("class",this.cssBetaImg))))},preSearch:function(){return!0},search:function(){if(this.preSearch()&&0!=this.onoffInitFlag){var a=this.input.val();null==a||0==a.replace(this.spaceRegExp,"").length||null!=a.match(this.spaceRegExp)?(this.usingChar="",this.sggstSelectNum=-1,this.hide()):a!=this.lastInput&&(this.backup=this.lastInput=a,clearTimeout(this.ajaxEvent),
this.ajaxEvent=setTimeout(function(){var a=rsuggest.lastInput.replace(rsuggest.spaceRegExp,"");if(0!=a.length){var c=rsuggest.config.attr(rsuggest.configCollection);if(0!=c.length)if("undefined"==typeof rsuggest.resultArray[c]&&(rsuggest.resultArray[c]=[]),"undefined"==typeof rsuggest.resultArray[c][a])try{var b=rsuggest.baseUrl+"/"+rsuggest.searchCommand+"?"+rsuggest.paramCollection+"="+c+"&"+rsuggest.paramReqid+"="+rsuggest.sggstReqid+"&"+rsuggest.paramSuggestid+"="+rsuggest.suggestId+"&"+rsuggest.paramInput+
"="+encodeURIComponent(a)+"&"+rsuggest.paramEncoding+"="+rsuggest.encoding;0!=rsuggest.exParam.length&&(b+="&"+rsuggest.exParam);rsuggest.read(b)}catch(e){}else rsuggest.show(rsuggest.resultArray[c][a],a,c)}},10),this.postSearch())}},postSearch:function(){},read:function(a){try{var d=this.lastInput,c=this.encoding,b=this.config.attr(this.configCollection);e.ajax({url:a,cache:!0,timeout:1E4,dataType:"jsonp",scriptCharset:c,jsonp:rsuggest.paramCallback,success:function(a){rsuggest.show(a,d,b)}})}catch(g){}},
eventStart:function(){clearInterval(this.viewEvent);this.clickEnableFlag=!0;this.decisionFlag=!1;this.viewEvent=setInterval(function(){rsuggest.nowFontSize=e("html").css("font-size");rsuggest.currentFontSize!=rsuggest.nowFontSize&&(rsuggest.currentFontSize=rsuggest.nowFontSize,rsuggest.resize());rsuggest.controlOnElem();rsuggest.search()},100)},eventStop:function(){clearInterval(this.viewEvent);setTimeout(function(){rsuggest.hide()},200)},preShow:function(){return!0},show:function(a,d,c){var b=this;
if(!b.preShow())return!1;if("undefined"==typeof a.result||"undefined"==typeof a.status||0!=a.status)b.maxIndex=0,b.hide();else if(0!=c.length&&"undefined"==typeof b.resultArray[c][d]&&(b.resultArray[c][d]=a),b.lastInput.replace(b.spaceRegExp,"")==d){var g=a.result.length;0==g?(b.maxIndex=0,b.hide()):(g>b.count&&(g=b.count),b.maxIndex=g,b.suggest.children("."+b.cssRemarks).remove(),b.index=-1,b.respInput=b.lastInput,b.suggest.children("."+b.cssSelect).attr("class",b.cssNoSelect).end().children("."+
b.cssNoSelect).each(function(c,d){if(c<g){var f=a.result[c][0],h=rsuggest.respInput.toLowerCase();if(0==f.indexOf(h)){var i="<strong>"+b.escapeHtml(h)+"</strong>",i=i+b.escapeHtml(f.replace(h,""));e(d).show().children("."+rsuggest.cssKeyword).html(i)}else e(d).show().children("."+rsuggest.cssKeyword).text(f)}else e(d).hide()}),b.suggest.append(b.remarks),b.mouseMove=0,setTimeout(function(){rsuggest.mouseMove=1},100),1==b.onoff&&b.suggest.show(),b.postShow())}},postShow:function(){},hide:function(a){a&&
0!=this.lastInput.length&&(this.input.val(this.backup),this.sggstSelectNum=-1,this.usingChar="");this.lastInput=this.input.val();this.suggest.hide()},select:function(a){var d=this.suggest.children("."+this.cssSelect).attr("class",this.cssNoSelect).end().children("."+this.cssNoSelect).eq(this.index);-1!=this.index&&d.attr("class",this.cssSelect);a&&(a="",-1>=this.index||this.index>=this.maxIndex?(a=this.backup,this.usingChar="",this.sggstSelectNum=-1):(this.usingChar=a=d.children("."+this.cssKeyword).text(),
this.sggstSelectNum=this.index),this.input.val(a),this.lastInput=a)},up:function(){0==this.maxIndex||(0==this.lastInput.length||0==this.config.attr(this.configCollection).length)||(-1>=this.index&&(this.index=this.maxIndex),this.suggest.is(":visible")?(this.index--,this.select(1)):this.respInput==this.lastInput&&1==this.onoff&&(this.select(),this.suggest.show()))},down:function(){0==this.maxIndex||(0==this.lastInput.length||0==this.config.attr(this.configCollection).length)||(this.index>=this.maxIndex&&
(this.index=-1),this.suggest.is(":visible")?(this.index++,this.select(1)):this.respInput==this.lastInput&&1==this.onoff&&(this.select(),this.suggest.show()))},over:function(a){var d=-1;this.suggest.children("."+this.cssSelect).attr("class",this.cssNoSelect).end().children("."+this.cssNoSelect).each(function(b,c){if(a==e(c).text())return d=b,!1});var c=1==this.keywordReplaceOnMouseover&&1==this.mouseMove;c&&(this.mouseOver=1,this.input.blur(),this.input.focus());this.index=d;this.select(c);setTimeout(function(){rsuggest.mouseOver=
0},50)},preJump:function(){return!0},jump:function(){if(this.preJump()){var a=this.isUse();this.scVal=1==this.decisionFlag?a:0;this.sendSubmitLog(a)}},sendSubmitLog:function(a){var d=this.config.attr(this.configCollection);if(0!=d.length){var c=this.input.val().replace(this.spaceRegExp,""),a=this.baseUrl+"/"+this.submitLogCommand+"?"+this.paramSuggestid+"="+this.suggestId+"&"+this.paramCollection+"="+d+"&"+this.paramReqid+"="+this.sggstReqid+"&"+this.paramSuggestOnOff+"="+this.onoff+"&"+this.paramSelectNum+
"="+this.sggstSelectNum+"&"+this.paramSelect+"="+encodeURIComponent(this.usingChar)+"&"+this.paramSuggestUse+"="+a+"&"+this.paramSubmitWay+"="+this.submitWay+"&"+this.paramInput+"="+encodeURIComponent(c);1==this.sendFormParam&&(a+="&"+this.paramFormParam+"="+encodeURIComponent(this.form.serialize()));0!=this.exParam.length&&(a+="&"+this.paramExParam+"="+encodeURIComponent(this.exParam));try{var b=this.encoding;this.config.attr(this.configCollection);e.ajax({url:a,cache:!0,timeout:3E3,async:!1,dataType:!e.browser.msie?
"json":"jsonp",scriptCharset:b,jsonp:rsuggest.paramCallback,success:function(){}})}catch(g){}}},isUse:function(){return 0!=this.usingChar.length&&0==this.input.val().indexOf(this.usingChar)?1:0},judge:function(){for(var a=this,d=navigator.userAgent.toLowerCase(),c=0;c<a.blackList.length;c++){var b=a.blackList[c];if(0!=b.length&&(b=RegExp("("+b+")"),null!=b.exec(d)))return-1}if(0!=a.addBlackList.length)for(var g=a.addBlackList.split(","),c=0;c<g.length;c++)if(b=g[c],0!=b.length&&-1!=d.indexOf(b))return-1;
e.browser.msie&&(a=this,c=e.browser.version,5<c&&7>c?a.IeVersion=6:6<c&&8>c&&(a.IeVersion=7));6==a.IeVersion&&(rsuggest.onoffEnable=0);for(c=0;c<a.onOffBlackList.length;c++)if(b=a.onOffBlackList[c],0!=b.length&&(b=RegExp("("+b+")"),null!=b.exec(d))){rsuggest.onoffEnable=0;break}return a.IeVersion},preResize:function(){return!0},resize:function(){if(this.preResize()){var a=this.getTextPos(),d;7==this.IeVersion&&(a=this.getIe7TextPos(a));d=a.top;var a=a.left,c=Math.ceil(this.input.outerHeight());this.suggest.css({top:d+
c,left:a});this.changeSuggestWidth();this.postResize()}},postResize:function(){},getTextPos:function(){return this.input.position()},getIe7TextPos:function(a){var d=[],c=document.body,b=c.getBoundingClientRect(),e=(b.right-b.left)/c.offsetWidth;d.top=Math.ceil(a.top/((b.bottom-b.top)/c.offsetHeight));d.left=Math.ceil(a.left/e);return d},changeSuggestWidth:function(){var a=this.input.outerWidth(),d=this.suggest.outerWidth();a!=d&&(this.suggest.css({width:a}),d=this.suggest.find("."+this.cssKeyword),
d.css({width:a-parseInt(d.css("paddingLeft"))-parseInt(d.css("paddingRight"))}))},onoffReady:function(){1==this.onoffEnable?(this.createOnElm(),this.createOffElm(),this.checkCookie()):this.setInitOnoffNum(1)},checkCookie:function(){e.ajax({type:"GET",url:this.baseUrl+"/"+this.cookieCommand+"?"+this.paramGroupId+"="+this.groupId+"&"+this.paramCookieMethod+"="+this.paramCookieCheck,dataType:"jsonp",timeout:500,jsonp:rsuggest.paramCallback,success:function(a){a=a.result;if("undefined"!=typeof a&&(0==
a||1==a))rsuggest.setInitOnoffNum(0==a?1:0)}});setTimeout(function(){rsuggest.setInitOnoffNum(1)},1E3)},setInitOnoffNum:function(a){1!=this.onoffInitFlag&&(this.onoff=a,this.onoffInitFlag=1,this.displayOnoff())},createOnElm:function(){this.onElem=e("<div />").hide().attr({"class":this.cssOn,title:this.openToolTips}).click(function(){rsuggest.setOnoffNum(1);rsuggest.input.focus();setTimeout(function(){rsuggest.lastInput=""},120)});this.input.after(this.onElem)},createOffElm:function(){this.offElem=
e("<div />").attr({"class":this.cssOff,title:this.hideToolTips}).append(e("<span />").attr("class",this.cssOffImage));this.remarks.children().append(this.offElem);this.suggest.delegate("."+this.cssOff,"mousedown",function(a){if(1!=a.which)rsuggest.input.blur();else return rsuggest.mouseState=1,rsuggest.setOnoffNum(0),rsuggest.input.blur(),!1});this.suggest.delegate("."+this.cssOff,"mouseout",function(){rsuggest.mouseState=0})},setOnoffNum:function(a){this.onoff=a;this.setCookie(a);this.displayOnoff()},
setCookie:function(a){e.ajax({type:"GET",url:this.baseUrl+"/"+this.cookieCommand+"?"+this.paramGroupId+"="+this.groupId+"&"+this.paramCookieMethod+"="+(1==a?this.paramCookieDelete:this.paramCookieAdd),dataType:"jsonp",timeout:500,jsonp:rsuggest.paramCallback,success:function(){}})},displayOnoff:function(){1==this.onoffEnable&&(1==this.onoff?(this.onElem.hide(),this.resize(),this.input.attr("autocomplete","off")):(this.resize(),this.input.attr("autocomplete",""),this.controlOnElem(),rsuggest.suggest.hide()))},
controlOnElem:function(){1!=this.onoffEnable||(0!=this.onoff||0==this.byteNumToHideOpenSggst)||(1==this.isByteLengthOver(this.input.val(),this.byteNumToHideOpenSggst)?this.onElem.hide():this.onElem.is(":visible")||this.onElem.show())},isSuggestUse:function(){return"undefined"!=typeof this.scVal&&1==this.scVal},isByteLengthOver:function(a,d){if(void 0===a)return 0;var c=0,b="",e=a.length,f;for(f=0;f<e;f++)if(b=escape(a.charAt(f)),c+=4>b.length&&!/%[0|1|8-9|A-F]\w|%7F/.test(b)?1:2,c>d)return 1;return 0}};
"undefined"!==typeof RSuggestHook&&e.extend(f.prototype,RSuggestHook.prototype);rsuggest=new f;rsuggest.config=e("#sggstConfig");rsuggest.input=e("#"+rsuggest.config.attr("input"));rsuggest.input.attr("autocomplete","off");e(document).ready(function(){rsuggest.preInit()||rsuggest.initFailure();rsuggest.form=e("#"+rsuggest.config.attr("form"));rsuggest.baseUrl=rsuggest.config.attr("baseUrl")||"";rsuggest.button=e("#"+rsuggest.config.attr("button"));rsuggest.suggestId=rsuggest.config.attr("suggestId")||
"";rsuggest.encoding=rsuggest.config.attr("encoding")||"";rsuggest.exParam=rsuggest.config.attr("exParam")||"";rsuggest.groupId=rsuggest.config.attr("groupId")||"";rsuggest.sendFormParam=rsuggest.checkBoolNum(rsuggest.config.attr("sendFormParam"))||1;rsuggest.onoffEnable=rsuggest.checkBoolNum(rsuggest.config.attr("onoff"))||1;rsuggest.keywordReplaceOnMouseover=rsuggest.checkBoolNum(rsuggest.config.attr("keywordReplaceOnMouseover"))||0;rsuggest.hookRequired=rsuggest.checkBoolNum(rsuggest.config.attr("hookRequired"))||
0;rsuggest.addBlackList=rsuggest.config.attr("uaBlackList")||"";var a=rsuggest.config.attr("byteNumToHideOpenSggst")||0;rsuggest.byteNumToHideOpenSggst=isNaN(a)||1>parseInt(a)?0:a;rsuggest.nowFontSize=e("html").css("font-size");rsuggest.hideToolTips=rsuggest.config.attr("hideToolTips")||"";rsuggest.openToolTips=rsuggest.config.attr("openToolTips")||"";if(0==rsuggest.input.length||0==rsuggest.form.length||0==rsuggest.baseUrl.length||0==rsuggest.button.length||0==rsuggest.suggestId.length||0==rsuggest.encoding.length||
0==rsuggest.groupId.length||0==rsuggest.sendFormParam.length||0==rsuggest.onoffEnable.length||0==rsuggest.keywordReplaceOnMouseover.length||0==rsuggest.hookRequired.length||-1==rsuggest.judge()||1!=rsuggest.input.parent(".sggstInputWrap").length||1==rsuggest.hookRequired&&"undefined"==typeof RSuggestHook){try{rsuggest.initFailure()}catch(d){}return!1}rsuggest.count=10;rsuggest.cssSelect="sggstSelect";rsuggest.cssNoSelect="sggstNoselect";rsuggest.cssKeyword="sggstKeyword";rsuggest.cssOnoff="sggstOnoff";
rsuggest.cssOffImage="sggstHideimg";rsuggest.cssOnImage="sggstOpenimg";rsuggest.cssRemarks="sggstComment";rsuggest.cssRemarksBox="sggstCommentbox";rsuggest.cssComment="sggstBetabtn01";rsuggest.cssBetaImg="betaimg";rsuggest.cssOff="sggstBetabtn02";rsuggest.cssOn="openSuggest";rsuggest.configCollection="col";rsuggest.paramInput="q";rsuggest.paramCollection="cl";rsuggest.paramSuggestid="sid";rsuggest.paramSuggestUse="su";rsuggest.paramSelectNum="sn";rsuggest.paramSuggestOnOff="so";rsuggest.paramFormParam=
"fp";rsuggest.paramReqid="rid";rsuggest.sggstReqid=Math.floor(1E10*Math.random());rsuggest.paramEncoding="oe";rsuggest.paramSelect="ss";rsuggest.sggstSelect="";rsuggest.searchCommand="suggest";rsuggest.submitLogCommand="submit";rsuggest.cookieCommand="conf";rsuggest.paramGroupId="gi";rsuggest.paramCookieMethod="mt";rsuggest.paramCookieCheck="c";rsuggest.paramCookieAdd="a";rsuggest.paramCookieDelete="d";rsuggest.paramSubmitWay="sw";rsuggest.paramCallback="cb";rsuggest.paramExParam="ex";rsuggest.createSuggestDiv();
rsuggest.onoffReady();rsuggest.resize();e(window).resize(function(){rsuggest.resize()});rsuggest.input.keydown(function(a){rsuggest.enterFlag=0;rsuggest.keyCode=a.keyCode;switch(a.keyCode){case 40:rsuggest.down();break;case 38:rsuggest.up();break;case 9:rsuggest.hide()}}).keypress(function(a){rsuggest.keyCode=a.keyCode;rsuggest.enterFlag=1;switch(a.keyCode){case 27:return 27==rsuggest.keyCode&&rsuggest.hide(!0),!1;case 13:return 13==rsuggest.keyCode&&(1==rsuggest.enterFlag&&1==rsuggest.clickEnableFlag)&&
(rsuggest.clickEnableFlag=0,rsuggest.decisionFlag=1,rsuggest.submitWay=1,setTimeout(function(){rsuggest.button.click()},10),rsuggest.eventStop()),!1}}).keyup(function(a){switch(a.keyCode){case 27:return 27==rsuggest.keyCode&&rsuggest.hide(!0),!1;case 13:return 13==rsuggest.keyCode&&(1==rsuggest.enterFlag&&1==rsuggest.clickEnableFlag)&&(rsuggest.clickEnableFlag=0,rsuggest.decisionFlag=1,rsuggest.submitWay=1,setTimeout(function(){rsuggest.button.click()},10),rsuggest.eventStop()),!1}}).focus(function(){rsuggest.lastInput=
rsuggest.input.val();0==rsuggest.mouseOver&&(rsuggest.backup=rsuggest.input.val());rsuggest.eventStart()}).blur(function(){0==rsuggest.mouseState&&0==rsuggest.mouseOver?rsuggest.eventStop():(1==rsuggest.mouseState||1==rsuggest.mouseOver)&&rsuggest.input.focus();rsuggest.mouseState=0}).mouseover(function(){1==rsuggest.keywordReplaceOnMouseover&&(rsuggest.suggest.is(":visible")&&-1!=rsuggest.index&&0!=rsuggest.backup.length&&rsuggest.lastInput==rsuggest.input.val())&&(rsuggest.input.val(rsuggest.backup),
rsuggest.sggstSelectNum=-1,rsuggest.usingChar="")}).attr("maxlength",2048);rsuggest.button.click(function(){try{rsuggest.jump()}catch(a){}return!0});document.activeElement.id==rsuggest.input.attr("id")&&(rsuggest.input.blur(),rsuggest.input.focus());rsuggest.postInit()})}})();
